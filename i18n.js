// ═══════════════════════════════════════════
// FOMUS PARURE — i18n (JA / EN / FR / AR)
// ═══════════════════════════════════════════

const I18N = {

  // ─── Navigation (shared) ───
  'nav.maison':        { ja: 'Maison', en: 'Maison', fr: 'Maison', ar: 'الدار' },
  'nav.collections':   { ja: 'Collections', en: 'Collections', fr: 'Collections', ar: 'المجموعات' },
  'nav.bespoke':       { ja: 'Bespoke', en: 'Bespoke', fr: 'Sur Mesure', ar: 'حسب الطلب' },
  'nav.menu':          { ja: 'MENU', en: 'MENU', fr: 'MENU', ar: 'القائمة' },

  // ─── Footer (shared) ───
  'footer.location':   { ja: 'Kyoto, Japan', en: 'Kyoto, Japan', fr: 'Kyoto, Japon', ar: 'كيوتو، اليابان' },

  // ═══════════════════════════════════════════
  // INDEX PAGE
  // ═══════════════════════════════════════════

  // The Maison
  'idx.maison.label':  { ja: 'The Maison', en: 'The Maison', fr: 'La Maison', ar: 'الدار' },
  'idx.maison.text': {
    ja: 'FOMUS PARUREは、<br>1300年にわたり受け継がれてきた<br>日本の「枡」から生まれた<br>ジュエリーメゾンです。',
    en: 'FOMUS PARURE is a jewelry maison<br>born from the Japanese "masu,"<br>a form passed down<br>for over 1,300 years.',
    fr: 'FOMUS PARURE est une maison de joaillerie<br>née du « masu » japonais,<br>une forme transmise<br>depuis plus de 1 300 ans.',
    ar: 'فوموس باروري هي دار مجوهرات<br>وُلدت من "الماسو" الياباني،<br>شكل توارثته الأجيال<br>لأكثر من 1300 عام.'
  },

  // Gift
  'idx.gift.label':    { ja: 'Masu as a Gift', en: 'Masu as a Gift', fr: 'Le Masu comme Cadeau', ar: 'الماسو كهدية' },
  'idx.gift.text': {
    ja: '枡は、日本では<br>縁起物として贈られてきたかたちです。<br><br>節目や祝いの場で、<br>良い兆しを分かち合うために選ばれてきました。',
    en: 'In Japan, the masu has long been<br>given as a symbol of good fortune.<br><br>Chosen to share blessings<br>at milestones and celebrations.',
    fr: 'Au Japon, le masu est depuis longtemps<br>offert comme symbole de bonne fortune.<br><br>Choisi pour partager les bénédictions<br>lors des grandes occasions.',
    ar: 'في اليابان، قُدّم الماسو منذ القدم<br>كرمز للحظ السعيد.<br><br>يُختار لمشاركة البركات<br>في المناسبات والاحتفالات.'
  },

  // Collections section
  'idx.col.label':     { ja: 'Collections', en: 'Collections', fr: 'Collections', ar: 'المجموعات' },
  'idx.col.title':     { ja: 'The Collection', en: 'The Collection', fr: 'La Collection', ar: 'المجموعة' },
  'idx.col.view':      { ja: 'View Details', en: 'View Details', fr: 'Voir les Détails', ar: 'عرض التفاصيل' },
  'idx.col.viewall':   { ja: 'View All Collections', en: 'View All Collections', fr: 'Voir Toutes les Collections', ar: 'عرض جميع المجموعات' },

  // High Craft
  'idx.hc.label':      { ja: 'High Craft', en: 'High Craft', fr: 'Haute Artisanat', ar: 'الحرفة الراقية' },
  'idx.hc.text': {
    ja: 'Selected pieces are created in collaboration<br>with Kyoto Cloisonné, a traditional Japanese craft.',
    en: 'Selected pieces are created in collaboration<br>with Kyoto Cloisonné, a traditional Japanese craft.',
    fr: 'Certaines pièces sont créées en collaboration<br>avec le Kyoto Cloisonné, un artisanat traditionnel japonais.',
    ar: 'تُصنع قطع مختارة بالتعاون<br>مع كيوتو كلوازوني، حرفة يابانية تقليدية.'
  },
  'idx.hc.textjp': {
    ja: '一部の作品は、日本の伝統工芸である<br>京七宝とのコラボレーションにより生まれています。',
    en: '',
    fr: '',
    ar: ''
  },
  'idx.hc.discover':   { ja: 'Discover', en: 'Discover', fr: 'Découvrir', ar: 'اكتشف' },

  // Bespoke
  'idx.bespoke.en': {
    ja: 'For special occasions and personal milestones.',
    en: 'For special occasions and personal milestones.',
    fr: 'Pour les occasions spéciales et les moments uniques.',
    ar: 'للمناسبات الخاصة واللحظات الفريدة.'
  },
  'idx.bespoke.jp': {
    ja: '大切な節目や、特別な贈り物のために。',
    en: '',
    fr: '',
    ar: ''
  },
  'idx.bespoke.cta':   { ja: 'Contact Concierge', en: 'Contact Concierge', fr: 'Contacter le Concierge', ar: 'تواصل مع الكونسيرج' },

  // ═══════════════════════════════════════════
  // COLLECTIONS PAGE
  // ═══════════════════════════════════════════

  'col.title':         { ja: 'Collections', en: 'Collections', fr: 'Collections', ar: 'المجموعات' },
  'col.coming':        { ja: 'Coming Soon', en: 'Coming Soon', fr: 'Bientôt Disponible', ar: 'قريباً' },
  'col.inquire':       { ja: 'Inquire', en: 'Inquire', fr: 'Se Renseigner', ar: 'استفسار' },
  'col.concierge':     { ja: 'Contact Concierge', en: 'Contact Concierge', fr: 'Contacter le Concierge', ar: 'تواصل مع الكونسيرج' },
  'col.close':         { ja: 'Close', en: 'Close', fr: 'Fermer', ar: 'إغلاق' },
  'col.appointment':   { ja: 'Available by appointment only.', en: 'Available by appointment only.', fr: 'Disponible sur rendez-vous uniquement.', ar: 'متاح فقط عن طريق الحجز المسبق.' },
  'col.incltax':       { ja: '(税込)', en: '(incl. tax)', fr: '(TTC)', ar: '(شامل الضريبة)' },

  // ═══════════════════════════════════════════
  // KYOTO CLOISONNÉ PAGE
  // ═══════════════════════════════════════════

  'kc.intro': {
    ja: '京七宝は、<br>京都で受け継がれてきた<br>日本の伝統工芸です。<br><br><br><br>FOMUS PARUREでは、<br>この繊細な技法を<br>「枡」のかたちの内に<br>静かに取り入れています。',
    en: 'Kyoto Cloisonné is<br>a traditional Japanese craft<br>passed down through generations in Kyoto.<br><br><br><br>At FOMUS PARURE,<br>this delicate technique is<br>quietly incorporated within<br>the form of the masu.',
    fr: 'Le Kyoto Cloisonné est<br>un artisanat traditionnel japonais<br>transmis de génération en génération à Kyoto.<br><br><br><br>Chez FOMUS PARURE,<br>cette technique délicate est<br>intégrée avec discrétion<br>dans la forme du masu.',
    ar: 'كيوتو كلوازوني هو<br>حرفة يابانية تقليدية<br>توارثتها الأجيال في كيوتو.<br><br><br><br>في فوموس باروري،<br>تُدمج هذه التقنية الرقيقة<br>بهدوء داخل<br>شكل الماسو.'
  },

  'kc.craft.label':    { ja: 'The Craft', en: 'The Craft', fr: 'Le Savoir-Faire', ar: 'الحرفة' },
  'kc.craft.1':        { ja: '京都にて一点ずつ制作', en: 'Crafted one by one in Kyoto', fr: 'Créé pièce par pièce à Kyoto', ar: 'يُصنع قطعة قطعة في كيوتو' },
  'kc.craft.2':        { ja: '伝統的な七宝技法を使用', en: 'Traditional cloisonné technique', fr: 'Technique traditionnelle du cloisonné', ar: 'تقنية كلوازوني التقليدية' },
  'kc.craft.3':        { ja: '完全受注生産', en: 'Made to order', fr: 'Fabrication sur commande', ar: 'يُصنع حسب الطلب' },
  'kc.craft.4':        { ja: 'デザインはご要望を伺い制作', en: 'Design discussed individually', fr: 'Design discuté individuellement', ar: 'يُناقش التصميم بشكل فردي' },
  'kc.craft.5':        { ja: '同じものは二つと存在しません', en: 'No two pieces are the same', fr: 'Aucune pièce n\'est identique', ar: 'لا توجد قطعتان متماثلتان' },

  'kc.piece': {
    ja: '木の温もりと、<br>七宝の奥行きある色彩。<br><br>相反する素材が、<br>ひとつのかたちに共存しています。',
    en: 'The warmth of wood<br>and the depth of cloisonné.<br><br>Contrasting materials<br>coexist in a single form.',
    fr: 'La chaleur du bois<br>et la profondeur du cloisonné.<br><br>Des matériaux contrastés<br>coexistent en une seule forme.',
    ar: 'دفء الخشب<br>وعمق ألوان الكلوازوني.<br><br>مواد متناقضة<br>تتعايش في شكل واحد.'
  },

  'kc.acq.label':      { ja: 'Acquisition', en: 'Acquisition', fr: 'Acquisition', ar: 'الاقتناء' },
  'kc.acq.jp': {
    ja: '本作品は、<br>ご要望を伺いながら<br>一点ずつ制作いたします。<br><br>そのため、<br>全く同じものは存在しません。',
    en: 'Each piece is created<br>upon individual request.<br><br>As a result,<br>no two pieces are ever the same.',
    fr: 'Chaque pièce est créée<br>sur demande individuelle.<br><br>Par conséquent,<br>aucune pièce n\'est jamais identique.',
    ar: 'تُصنع كل قطعة<br>بناءً على طلب فردي.<br><br>لذلك،<br>لا توجد قطعتان متماثلتان أبداً.'
  },
  'kc.acq.aside': {
    ja: 'Each piece is created upon request.<br>No two pieces are ever the same.',
    en: 'Each piece is created upon request.<br>No two pieces are ever the same.',
    fr: 'Chaque pièce est créée sur demande.<br>Aucune n\'est jamais identique.',
    ar: 'كل قطعة تُصنع حسب الطلب.<br>لا توجد قطعتان متماثلتان.'
  },
  'kc.cta.inquire':    { ja: 'Inquire', en: 'Inquire', fr: 'Se Renseigner', ar: 'استفسار' },
  'kc.cta.concierge':  { ja: 'Contact Concierge →', en: 'Contact Concierge →', fr: 'Contacter le Concierge →', ar: '← تواصل مع الكونسيرج' },
  'kc.back':           { ja: '← Back to Collections', en: '← Back to Collections', fr: '← Retour aux Collections', ar: 'العودة إلى المجموعات →' },

  // ─── Product descriptions (collections page) ───
  'prod.desc.earring-tonbodama-blue': {
    ja: '伝統的なトンボ玉の技法を用いた、深い青の輝きが耳元を彩るイヤリング。枡のかたちに宿る日本の美意識を、現代のジュエリーとして昇華しました。',
    en: 'An earring adorned with deep blue brilliance using traditional Tonbo-dama technique. Japanese aesthetics embodied in the masu form, elevated as contemporary jewelry.',
    fr: 'Une boucle d\'oreille ornée d\'un éclat bleu profond utilisant la technique traditionnelle Tonbo-dama. L\'esthétique japonaise incarnée dans la forme du masu.',
    ar: 'قرط مزين ببريق أزرق عميق باستخدام تقنية تونبو-داما التقليدية. الجمالية اليابانية مجسدة في شكل الماسو.'
  },
  'prod.desc.necklace-white': {
    ja: '白の静謐さを胸元に纏う。枡のかたちから生まれたペンダントが、洗練された日常に寄り添います。',
    en: 'Wear the serenity of white at your décolletage. A pendant born from the masu form, accompanying refined daily life.',
    fr: 'Portez la sérénité du blanc à votre décolleté. Un pendentif né de la forme du masu, accompagnant un quotidien raffiné.',
    ar: 'ارتدِ هدوء اللون الأبيض على صدرك. قلادة وُلدت من شكل الماسو، ترافق الحياة اليومية الراقية.'
  },
  'prod.desc.necklace-yellow': {
    ja: '温かみのある黄色が、枡のフォルムとともに胸元で静かに存在感を放つネックレス。日常の中に小さな華やぎを。',
    en: 'A warm yellow quietly radiates at the chest alongside the masu form. A touch of elegance in everyday life.',
    fr: 'Un jaune chaleureux rayonne doucement sur la poitrine avec la forme du masu. Une touche d\'élégance au quotidien.',
    ar: 'أصفر دافئ يشع بهدوء على الصدر مع شكل الماسو. لمسة من الأناقة في الحياة اليومية.'
  },
  'prod.desc.pierce-white-flower': {
    ja: '白い花のモチーフが耳元で揺れる。枡の伝統美と花の繊細さが調和したピアス。',
    en: 'White flower motifs sway at the ear. A piercing that harmonizes the traditional beauty of masu with floral delicacy.',
    fr: 'Des motifs de fleurs blanches oscillent à l\'oreille. Un piercing harmonisant la beauté traditionnelle du masu avec la délicatesse florale.',
    ar: 'زخارف الزهور البيضاء تتمايل عند الأذن. حلق يجمع بين جمال الماسو التقليدي ورقة الأزهار.'
  },
  'prod.desc.earring-red-blossom': {
    ja: '紅の花弁が耳元で静かに咲く。枡のかたちに日本の花の美を重ねた、華やかでありながら品のある一品。',
    en: 'Crimson petals bloom quietly at the ear. The beauty of Japanese flowers layered upon the masu form — vibrant yet refined.',
    fr: 'Des pétales pourpres s\'épanouissent doucement à l\'oreille. La beauté des fleurs japonaises sur la forme du masu — éclatante et raffinée.',
    ar: 'بتلات قرمزية تتفتح بهدوء عند الأذن. جمال الأزهار اليابانية متراكب على شكل الماسو — نابض بالحياة وراقٍ.'
  },
  'prod.desc.earring-white-blossom': {
    ja: '白い花が耳元にそっと寄り添う。清楚な美しさと枡の端正なフォルムが調和したイヤリング。',
    en: 'White blossoms gently rest at the ear. An earring harmonizing pure beauty with the refined masu form.',
    fr: 'Des fleurs blanches se posent doucement à l\'oreille. Une boucle d\'oreille harmonisant la beauté pure avec la forme raffinée du masu.',
    ar: 'أزهار بيضاء تستقر برفق عند الأذن. قرط يجمع بين الجمال النقي وشكل الماسو الراقي.'
  },
  'prod.desc.earring-temari-black': {
    ja: '手毬の精緻な文様を黒で表現した、凛とした佇まいのイヤリング。伝統工芸の技が、現代の装いに深みを添えます。',
    en: 'An earring expressing temari\'s intricate patterns in black — a dignified presence. Traditional craftsmanship adds depth to contemporary style.',
    fr: 'Une boucle d\'oreille exprimant les motifs complexes du temari en noir — une présence distinguée. L\'artisanat traditionnel ajoute de la profondeur au style contemporain.',
    ar: 'قرط يعبر عن أنماط التيماري المعقدة باللون الأسود — حضور وقور. الحرفية التقليدية تضيف عمقاً للأسلوب المعاصر.'
  },
  'prod.desc.pierce-red-blossom': {
    ja: '紅の花弁を纏ったピアス。枡のかたちの中に宿る日本の花の美が、耳元で静かに物語を紡ぎます。',
    en: 'A piercing adorned with crimson petals. The beauty of Japanese flowers within the masu form, quietly weaving a story at the ear.',
    fr: 'Un piercing orné de pétales pourpres. La beauté des fleurs japonaises dans la forme du masu, tissant doucement une histoire à l\'oreille.',
    ar: 'حلق مزين ببتلات قرمزية. جمال الأزهار اليابانية داخل شكل الماسو، ينسج بهدوء قصة عند الأذن.'
  },
  'prod.desc.pierce-temari-white': {
    ja: '白い手毬の繊細な文様をピアスに。伝統的な美意識を日常の装いに取り入れる、上品な一品。',
    en: 'Delicate white temari patterns in a piercing. An elegant piece bringing traditional aesthetics into everyday style.',
    fr: 'Des motifs délicats de temari blanc en piercing. Une pièce élégante intégrant l\'esthétique traditionnelle au style quotidien.',
    ar: 'أنماط تيماري بيضاء رقيقة في حلق. قطعة أنيقة تدمج الجمالية التقليدية في الأسلوب اليومي.'
  },
  'prod.desc.pierce-black-blossom': {
    ja: '黒い花弁が耳元に凛と咲く。モダンな色彩と枡の伝統美が出会う、洗練されたピアス。',
    en: 'Black petals bloom with dignity at the ear. A refined piercing where modern color meets the traditional beauty of masu.',
    fr: 'Des pétales noirs s\'épanouissent avec dignité à l\'oreille. Un piercing raffiné où la couleur moderne rencontre la beauté traditionnelle du masu.',
    ar: 'بتلات سوداء تتفتح بوقار عند الأذن. حلق راقٍ حيث يلتقي اللون العصري بجمال الماسو التقليدي.'
  },
  'prod.desc.earring-yellow-flower': {
    ja: '黄色い花のモチーフが、耳元に温かな彩りを添えるイヤリング。枡の端正なかたちと花の柔らかさが調和します。',
    en: 'Yellow flower motifs add warm color at the ear. The refined masu form and floral softness in harmony.',
    fr: 'Des motifs de fleurs jaunes ajoutent une couleur chaude à l\'oreille. La forme raffinée du masu et la douceur florale en harmonie.',
    ar: 'زخارف الزهور الصفراء تضيف لوناً دافئاً عند الأذن. شكل الماسو الراقي ونعومة الأزهار في تناغم.'
  },
  'prod.desc.earring-white-flower': {
    ja: '白い花が耳元で清らかに揺れる。花と枡が織りなす、繊細で上品なイヤリング。',
    en: 'White flowers sway purely at the ear. A delicate, refined earring woven from flower and masu.',
    fr: 'Des fleurs blanches oscillent purement à l\'oreille. Une boucle d\'oreille délicate et raffinée tissée de fleur et de masu.',
    ar: 'أزهار بيضاء تتمايل بنقاء عند الأذن. قرط رقيق وراقٍ منسوج من الأزهار والماسو.'
  }
};

// ═══════════════════════════════════════════
// Language Switcher Engine
// ═══════════════════════════════════════════

function t(key, lang) {
  const entry = I18N[key];
  if (!entry) return '';
  return entry[lang] || entry['ja'] || '';
}

function getCurrentLang() {
  return localStorage.getItem('fomus-lang') || 'ja';
}

function setLang(lang) {
  localStorage.setItem('fomus-lang', lang);

  // RTL for Arabic
  if (lang === 'ar') {
    document.documentElement.dir = 'rtl';
    document.documentElement.lang = 'ar';
  } else {
    document.documentElement.dir = 'ltr';
    document.documentElement.lang = lang;
  }

  // Translate all data-i18n elements
  document.querySelectorAll('[data-i18n]').forEach(el => {
    const key = el.dataset.i18n;
    const val = t(key, lang);
    if (val !== undefined) {
      el.innerHTML = val;
    }
  });

  // Hide .jp helper text in non-JA
  document.querySelectorAll('[data-i18n-hide]').forEach(el => {
    el.style.display = (lang === 'ja') ? '' : 'none';
  });

  // Update active state on switcher
  document.querySelectorAll('.lang-btn').forEach(btn => {
    btn.classList.toggle('lang-active', btn.dataset.lang === lang);
  });

  // Fire custom event for JS-rendered content (collections page)
  window.dispatchEvent(new CustomEvent('langchange', { detail: { lang } }));
}

// ─── Inject Switcher UI into Nav ───
function initLangSwitcher() {
  const nav = document.querySelector('.nav-inner');
  if (!nav) return;

  const switcher = document.createElement('div');
  switcher.className = 'lang-switcher';
  switcher.innerHTML = `
    <button class="lang-btn" data-lang="ja">JA</button>
    <button class="lang-btn" data-lang="en">EN</button>
    <button class="lang-btn" data-lang="fr">FR</button>
    <button class="lang-btn" data-lang="ar">AR</button>
  `;
  nav.appendChild(switcher);

  switcher.querySelectorAll('.lang-btn').forEach(btn => {
    btn.addEventListener('click', () => setLang(btn.dataset.lang));
  });

  // Apply stored language
  setLang(getCurrentLang());
}

// ─── Inject Switcher CSS ───
function initLangStyles() {
  const style = document.createElement('style');
  style.textContent = `
    .lang-switcher {
      display: flex;
      gap: 4px;
      margin-left: 24px;
    }
    .lang-btn {
      font-family: 'Cormorant Garamond', serif;
      font-size: 10px;
      letter-spacing: 0.1em;
      padding: 4px 8px;
      color: #999;
      background: none;
      border: 1px solid transparent;
      cursor: pointer;
      transition: all 0.3s;
    }
    .lang-btn:hover {
      color: inherit;
    }
    .lang-active {
      color: inherit;
      border-color: currentColor;
    }
    /* Nav scrolled state (index page) */
    .nav.scrolled .lang-btn { color: #999; }
    .nav.scrolled .lang-active { color: var(--charcoal, #1A1A1A); border-color: var(--charcoal, #1A1A1A); }
    /* Non-scrolled (index hero) */
    .nav:not(.scrolled) .lang-btn { color: rgba(255,255,255,0.5); }
    .nav:not(.scrolled) .lang-active { color: rgba(255,255,255,0.9); border-color: rgba(255,255,255,0.4); }
    /* Pages without scroll class (collections, kc) */
    .nav:not(#nav) .lang-btn { color: #999; }
    .nav:not(#nav) .lang-active { color: var(--charcoal, #1A1A1A); border-color: var(--charcoal, #1A1A1A); }

    /* RTL adjustments */
    [dir="rtl"] .lang-switcher { margin-left: 0; margin-right: 24px; }
    [dir="rtl"] .nav-inner { flex-direction: row-reverse; }
    [dir="rtl"] .nav-links { flex-direction: row-reverse; }
    [dir="rtl"] .craft-inner { flex-direction: column; }
    [dir="rtl"] .acquisition-inner { flex-direction: column; }
    @media (min-width: 768px) {
      [dir="rtl"] .craft-inner { flex-direction: row-reverse; }
      [dir="rtl"] .acquisition-inner { flex-direction: row-reverse; }
    }

    @media (max-width: 767px) {
      .lang-switcher {
        gap: 2px;
      }
      .lang-btn {
        font-size: 9px;
        padding: 3px 6px;
      }
    }
  `;
  document.head.appendChild(style);
}

// ─── Init ───
document.addEventListener('DOMContentLoaded', () => {
  initLangStyles();
  initLangSwitcher();
});
